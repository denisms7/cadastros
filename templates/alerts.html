<div id="alerts-wrapper"
     style="position: fixed; bottom: 20px; right: 20px; z-index: 1050; width: 400px;">

    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show shadow"
                 role="alert">
                {{ message|linebreaksbr }}
                <button type="button"
                        class="btn-close"
                        data-bs-dismiss="alert"
                        aria-label="Close"></button>

                <div class="progress" style="height: 3px; margin-top: 5px;">
                    <div class="progress-bar bg-{{ message.tags }}"
                         style="width: 100%; transition: width 10s linear;"></div>
                </div>
            </div>
        {% endfor %}
    {% endif %}

</div>


<script>
    const initAlert = (alert) => {
        const progressBar = alert.querySelector('.progress-bar');

        // inicia animação da barra
        setTimeout(() => {
            if (progressBar) {
                progressBar.style.width = '0%';
            }
        }, 100);

        // fecha automaticamente após 10s
        setTimeout(() => {
            alert.classList.remove('show');
            setTimeout(() => alert.remove(), 500);
        }, 10000);
    };

    // Função global para criar alertas dinâmicos
    window.fireAlert = (message, type = 'info') => {
        const wrapper = document.getElementById('alerts-wrapper');
        if (!wrapper) return;

        const alert = document.createElement('div');
        alert.className = `alert alert-${type} alert-dismissible fade show shadow`;
        alert.setAttribute('role', 'alert');

        alert.innerHTML = `
            ${message}
            <button type="button"
                    class="btn-close"
                    data-bs-dismiss="alert"
                    aria-label="Close"></button>

            <div class="progress" style="height: 3px; margin-top: 5px;">
                <div class="progress-bar bg-${type}"
                    style="width: 100%; transition: width 10s linear;"></div>
            </div>
        `;

        wrapper.appendChild(alert);
        initAlert(alert);
    };

    document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('.alert').forEach(initAlert);
    });
</script>
